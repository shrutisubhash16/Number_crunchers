{% load static %}
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <title>Coal India Website</title>

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- Bootstrap CSS CDN -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css"
        integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">


    <!-- Font Awesome JS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css"
        integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/solid.js"
        integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ"
        crossorigin="anonymous"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/fontawesome.js"
        integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY"
        crossorigin="anonymous"></script>
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/fontawesome.min.css"
        integrity="sha384-jLKHWM3JRmfMU0A5x5AkjWkw/EYfGUAGagvnfryNV3F9VqM98XiIH7VBGVoxVSc7" crossorigin="anonymous">

    <link rel="stylesheet" href="{% static 'wel.css' %}">
</head>

<body>
    <div class="wrapper">
        <!-- Sidebar  -->
        <nav id="sidebar">
            <div class="sidebar-header">
                <h2 style="text-align: center;">Coal India Limited</h2>
                <strong>C.I.L</strong>
            </div>

            <ul class="list-unstyled components">
                <li class="active">
                    <a href="#homeSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
                        <i class="fas fa-cube" aria-hidden="true" style="margin-right:10px ;"></i>
                        <h5 style="display: inline;">Dashboard</h5>

                    </a>
                    <ul class="collapse list-unstyled" id="homeSubmenu">
                        <li>
                            <a onclick="toggle()">Graph1</a>
                        </li>
                        <li>
                            <a onclick="toggle()">Graph2</a>
                        </li>
                        <li>
                            <a href="#">Graph3</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a onclick="location.href='{% url 'signIn' %} '">
                        <i class="fa-solid fa-user"></i>
                        <h5 style="display: inline;">Login</h5>
                    </a>
                    <!--<a href="#pageSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
                        <i class="fas fa-check-circle"></i>
                        <h5 style="display: inline;">Proposal</h5>
                    </a>
                    <ul class="collapse list-unstyled" id="pageSubmenu">
                        <li>
                            <a href="#">Winter</a>
                        </li>
                        <li>
                            <a href="#">Spring</a>
                        </li>
                    </ul>
                </li>
                -->
                <li>
                    <a>
                        <i class="fas fa-check-circle" style="margin-right:10px ;"></i>
                        <h5 style="display: inline;">Features</h5>
                    </a>
                </li>
                <li>
                    <a onclick="location.href='{% url 'compare' %} '">
                        <i class="fa-solid fa-code-compare"></i>
                        <h5 style="display: inline;">Compare</h5>
                    </a>
                </li>
                <li>
                    <a onclick="location.href='{% url 'signup' %} '">
                        <i class="fa fa-user-plus" style="margin-right:10px ;"></i>
                        <h5 style="display: inline;">Add User</h5>
                    </a>
                </li>
                <li>
                    <a onclick="location.href='{% url 'load' %} '">
                        <i class="fa fa-user-plus" style="margin-right:10px ;"></i>
                        <h5 style="display: inline;">Monitor weight</h5>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class="fa-solid fa-phone"></i>
                        <h5 style="display: inline;">Contact us</h5>
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Page Content  -->
        <div id="content">

            <button type="button" id="sidebarCollapse" class="btn btn-info" style="background-color: #333;">
                <i class="fas fa-align-left" style="color: white; "></i>
            </button>

            <button type="button" onclick="location.href='{% url 'log' %}' "
                style="background-color: #333; color: white; float: right;">Logout</button>
            <br><br>
            <i class="fas fa-solid fa-user"></i>
            <h6 style="display: inline;">{{e}}</h6>

            <div class="row mt-4" style="display: flex; align-items: center; justify-content: center;">
                <div class="card col-lg-4 m-1"
                    style="width: 19rem; height: 12rem; background-color: rgb(194, 243, 227);">
                    <div class="card-body">
                        <h5 class="card-title text-center" style="color: black;">375</h5>
                        <h6 class="card-subtitle mb-4 text-muted text-center">Total RFID Install</h6>
                        <div style="display: flex; align-items: center; justify-content: center;">
                            <section class="mr-2">
                                <a href="#" class="card-link"
                                    style="display: flex; align-items: center; justify-content: center;">300</a>
                                <a href="#" class="card-link">Entry Gate</a>
                            </section>
                            <section class="ml-2">
                                <a href="#" class="card-link"
                                    style="display: flex; align-items: center; justify-content: center;">275</a>
                                <a href="#" class="card-link">Exit Gate</a>
                            </section>
                        </div>
                    </div>
                </div>

                <div class="card col-lg-4 m-1"
                    style="width: 19rem; height: 12rem; background-color: rgb(226, 210, 241);">
                    <div class="card-body">
                        <h5 class="card-title text-center" style="color: black;">795</h5>
                        <h6 class="card-subtitle mb-4 text-muted text-center">Total No. of Trucks</h6>
                        <div style="display: flex; align-items: center; justify-content: center;">
                            <section class="mr-2">
                                <a href="#" class="card-link"
                                    style="display: flex; align-items: center; justify-content: center;">300</a>
                                <a href="#" class="card-link">Entered</a>
                            </section>
                            <section class="ml-2">
                                <a href="#" class="card-link"
                                    style="display: flex; align-items: center; justify-content: center;">75</a>
                                <a href="#" class="card-link">Left</a>
                            </section>
                        </div>
                    </div>
                </div>

                <div class="card col-lg m-1" style="width: 19rem; height: 12rem; background-color: rgb(250, 224, 224);">
                    <div class="card-body">
                        <h5 class="card-title text-center" style="color: black;">502</h5>
                        <h6 class="card-subtitle mb-4 text-muted text-center">Total Coal Present</h6>
                        <div style="display: flex; align-items: center; justify-content: center;">
                            <section class="mr-2">
                                <a href="#" class="card-link"
                                    style="display: flex; align-items: center; justify-content: center;">300</a>
                                <a href="#" class="card-link">Anthracite</a>
                            </section>
                            <section class="ml-2">
                                <a href="#" class="card-link"
                                    style="display: flex; align-items: center; justify-content: center;">175</a>
                                <a href="#" class="card-link">Lignite</a>
                            </section>
                        </div>
                    </div>
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="col-md-12 graph">
                    <h4 style="text-align: center;">Statitics of Trucks</h4>
                    <div id="chart" style="width:80%; height:500px; margin:0 auto;"></div>
                </div>
                <div class="col-md-12 graph">
                    <h4 style="text-align: center;">Graph1</h4>
                    <canvas id="myChartline"></canvas>
                </div>
                <div class="col-md-12 graph">
                    <h4 style="text-align: center;">Graph2</h4>
                    <canvas id="myChartBar"></canvas>
                </div>
            </div>


            <table class="table table-dark table-striped scrolldown">
                <thead>
                    <tr>
                        <th>Booking ID</th>
                        <th>Booking ID Date</th>
                        <th>Current Location</th>
                        <th>Destination Location</th>
                        <th>Vehicle No</th>
                    </tr>
                </thead>
                <tbody>

                    {% if d %}
                    {% for i in d %}
                    <tr>
                        <td>{{i.BookingID}}</td>
                        <td>{{i.BookingID_Date}}</td>
                        <td>{{i.Current_Location}}</td>
                        <td>{{i.DestinationLocation}}</td>
                        <td>{{i.vehicle_no}}</td>
                    </tr>
                    {% endfor %}
                    {% endif %}
                </tbody>
            </table>

        </div>

        <div>


        </div>



    </div>


    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    <!-- jQuery CDN - Slim version (=without AJAX) -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <!-- Popper.JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"
        integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ"
        crossorigin="anonymous"></script>
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"
        integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm"
        crossorigin="anonymous"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            $('#sidebarCollapse').on('click', function () {
                $('#sidebar').toggleClass('active');
            });
        });



    </script>
    <script src="https://code.jscharting.com/2.9.0/jscharting.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="{% static 'styles.css' %}">
    <script src="{% static 'wel.js' %}"></script>
    <script>
        var endpoint = '/api';

        $.ajax({
            method: "GET",
            url: endpoint,
            success: function (data) {
                console.log("Calling");
                drawLineGraph(data, 'myChartline');
                drawBarGraph(data, 'myChartBar');
                console.log("drawing");
            },
            error: function (error_data) {
                console.log(error_data);
            }
        })


        function drawLineGraph(data, id) {
            var labels = data.labels;
            var chartLabel = data.chartLabel;
            var chartdata = data.chartdata;
            var ctx = document.getElementById(id).getContext('2d');
            var chart = new Chart(ctx, {
                // The type of chart we want to create
                type: 'line',

                // The data for our dataset
                data: {
                    labels: labels,
                    datasets: [{
                        label: chartLabel,
                        backgroundColor: 'rgb(255, 100, 200)',
                        borderColor: 'rgb(55, 99, 132)',
                        data: chartdata,
                    }]
                },

                // Configuration options go here
                options: {
                    scales: {
                        xAxes: [{
                            display: true,
                            title: "TimeStamp",
                            scaleLabel: {
                                display: true,
                                labelString: 'TimeStamp'
                            }
                        }],
                        yAxes: [{
                            ticks: {
                                beginAtZero: true,
                                title: "Number_plate"
                            },
                            scaleLabel: {
                                display: true,
                                labelString: 'Number Plate No.'
                            }
                        }]
                    }
                }

            });
        }

        function drawBarGraph(data, id) {
            var labels = data.labels;
            var chartLabel = data.chartLabel;
            var chartdata = data.chartdata;
            var ctx = document.getElementById(id).getContext('2d');
            var myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: chartLabel,
                        data: chartdata,
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.2)',
                            'rgba(54, 162, 235, 0.2)',
                            'rgba(255, 206, 86, 0.2)',
                            'rgba(75, 192, 192, 0.2)',
                            'rgba(153, 102, 255, 0.2)',
                            'rgba(255, 159, 64, 0.2)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(75, 192, 192, 1)',
                            'rgba(153, 102, 255, 1)',
                            'rgba(255, 159, 64, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    }
                }
            });
        }

        JSC.Chart('chart', {
            debug: true,
            legend_position: 'bottom right',
            type: 'area spline',
            defaultSeries: { shape_opacity: 0.5 },
            xAxis: {
                crosshair_enabled: true,
                scale: { type: 'time' }
            },
            title_label_text: 'Number of trucks',
            title_label_color: "orange",
            //yAxis: { formatString: 'c' }, 
            yAxis_label_color: "#FF0000",
            series: [
                {
                    name: 'Truck entered',
                    points: [
                        ['1/1/2020', 1005],
                        ['2/1/2020', 3202],
                        ['3/1/2020', 1345],
                        ['4/1/2020', 2341],
                        ['5/1/2020', 1440],
                        ['6/1/2020', 1780]
                    ]
                },
                {
                    name: 'Truck Leave ',
                    points: [
                        ['1/1/2020', 2698],
                        ['2/1/2020', 2795],
                        ['3/1/2020', 1954],
                        ['4/1/2020', 2702],
                        ['5/1/2020', 1230],
                        ['6/1/2020', 1110]
                    ]
                }
            ]
        });

    </script>

</body>

</html>